import sys
import time
from collections import deque
from itertools import combinations, permutations

def Input_Data():
	readl = sys.stdin.readline
	R, C = map(int,readl().split())
	map_city = [readl().strip() for _ in range(R)]
	return R, C, map_city

R, C, map_city = Input_Data()

# 여기서부터 작성
start_time = time.time()
INF = 9876543210

# 딕셔너리 변수는 key_value형태로 네이밍
point_pos = dict()
dir = [[1,0],[-1,0],[0,1],[0,-1]]

# 각 포인트의 위치 딕셔너리에 저장
for i in range(R):
	for j in range(C):
		if map_city[i][j] == 'S':
			point_pos['S'] = [i, j]
		if map_city[i][j] != '.' and map_city[i][j] != '*':
			point_pos[map_city[i][j]] = [i, j]
# print(point_pos)


# 두 점간 위치 최단거리 BFS로 구현
# S:[sy, sx], E = [ey, ex]
def bfs(S, E):
	sy, sx = S[0], S[1]
	ey, ex = E[0], E[1]
	dist[sy][sx] = 0
	Q = deque()
	Q.append([sy, sx])
	while Q:
		y, x = Q.popleft()
		for dy, dx in dir:
			ny, nx = y+dy, x+dx
			if 0<=ny<R and 0<=nx<C and map_city[ny][nx] != '*' and dist[ny][nx] > dist[y][x]+1:
				dist[ny][nx] = dist[y][x]+1
				Q.append([ny,nx])
	return dist[ey][ex]
# test_bfs = bfs([0,1], [3,0])


combTwoPoint = combinations(point_pos.keys(), 2)
# print("combTowPoint: ", combTwoPoint)
twoPoint_dist = dict()

# 두 포인트 간 최단거리 미리 구해놓기, twoPoint_dist의 키로 (s, e), (e, s) 모두 저장, 최대 키 90개
for point1 in point_pos.keys():
	dist = [[INF]*C for _ in range(R)]		# 각 시작 포인트에서만 dist배열 초기화
	for point2 in point_pos.keys():
		if point1 != point2:
			start, end = point_pos[point1], point_pos[point2]
			distance = bfs(start, end)
			twoPoint_dist[(point1, point2)] = distance
print(twoPoint_dist)


# S를 제외한 리스트 생성 -> 해당 리스트로 순열 생성 -> 모든 경우의 수에 대해 최단거리 비교
pointList = list(point_pos)
pointList.remove('S')
P = permutations(pointList,len(pointList))		
# print("P: ", list(P))
min_dis = INF
# 모든 경우의 수에 대해 하나씩 확인
for p in P:			# Big-O : 최대 9! = 362880
	tmp_dis = 0
	s = 'S'
	for point in p:
		e = point
		tmp_dis += twoPoint_dist[(s,e)]
		if tmp_dis > min_dis:		# 시간 줄이기 위한 중간 가지치기
			break
		s = point
	e = 'S'
	tmp_dis += twoPoint_dist[(s,e)]            
	min_dis = min(min_dis, tmp_dis)
print(min_dis)		# 답

print("실행시간 :", time.time() - start_time, "초")


# 풀이:
# 1) 각 포인트의 위치 딕셔너리에 저장
# 2) 두 지점간 최단거리 BFS로 구현
# 3) 두 지점 간 최단거리 딕셔너리에 저장 (예){(s,e):거리, ...}
# 4) 순열로 모든 케이스 확인 시 worst case 일 때 362880 번만 수행하기에 시간초과 없을 것으로 예상됨 
# 5) 순열 돌며 모든 케이스에 대해 총 거리 비교하여 최단경로 업데이트 



# 입력 기억 안남 아래는 기억 의존 비슷 구현:
# 5 5
# .S*.1
# ..*2.
# 3....
# .....
# ...4.

# 출력(위 입력에 맞는 답):
# 20


# 테스트케이스 제작:
# TC1 : 정답 맞는지 확인을 위한 TC
# 3 3
# S.1
# **.
# 2..

# TC2 :정답 맞는지 확인을 위한 TC
# 4 4
# S...
# *1*3
# ..5.
# 4...

# TC3: worst case 시간 측정을 위한 TC

# 100 100
# S...................................................................................................
# ***************************************************************************************************1
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# .................................................7..................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# .................................................6..................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ..............................................5.....................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# .................................................................8..................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ..........4.........................................................................................
# ***************************************************************************************************.
# ....................................................................................................
# .***************************************************************************************************
# ....................................................................................................
# ***************************************************************************************************3
# ....................................................................................................
# .***************************************************************************************************
# ..........................................................................9.........................
# ***************************************************************************************************.
# ....................................................................................................
# 2***************************************************************************************************



# TC4: worst case 시간 측정을 위한 TC

# 100 100
# ..........................................................................................S.........
# ..............................*............................*****************************************
# ..............................1*..................................................................*.
# ..................................................................................................*2
# ...******.........................................................................................*.
# ........*.........................................**********......................................*.
# .......5*.........................................*3*...............................................
# ........*...........................................................................................
# ........*.......*..............................................................................*****
# ........*......6*...................................................................................
# ........*.......*...................................................................................
# ........*...........................................................................................
# ........*...........................................................................................
# ........*...........................................................................................
# ........*...........................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ................**..................................................................................
# ................*9..................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ......................................................*.............................................
# .....................................................*4.............................................
# ......................................................*.............................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................
# .....7...................................................................................*8.........
# ....................................................................................................
# ....................................................................................................
# ....................................................................................................